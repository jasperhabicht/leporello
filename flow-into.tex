\documentclass[prepress]{leporello}
\usepackage{lipsum}

\ExplSyntaxOn

\int_new:N \l_leporello_box_flow_into_int
\box_new:N \g_leporello_box_flow_temp_box

\keys_define:nn { leporello / box } {
    flow ~ into  .code:n = {
        \prop_gput:cne { g_leporello_box_ \int_use:N \g_leporello_box_int _prop } 
            { flow ~ into } {#1}
    }
}

\msg_new:nnn { leporello } { column-widths-different } {
    \msg_warning_text:n { leporello } \iow_newline:
    Flow ~ across ~ columns ~ with ~ different ~ width: \iow_newline:
    #1 ~ and ~ #2 . \iow_newline:
    Consider ~ using ~ \token_to_str:N \leporellobreakbox .
}

\AddToHook { leporello / box / before } {
    \prop_if_in:cnT { g_leporello_box_ \int_use:N \l_leporello_current_box_int _prop } 
        { flow ~ into } {
        \int_set:Nn \l_leporello_box_flow_into_int {
            \prop_item:cn { g_leporello_box_ \int_use:N \l_leporello_current_box_int _prop } 
                { flow ~ into }
        }
        \dim_compare:nNnF {
            \clist_item:Nn \l_leporello_columns_clist { \l_leporello_current_column_int }
        } = {
            \clist_item:Nn \l_leporello_columns_clist { \l_leporello_box_flow_into_int }
        } {
            \msg_warning:nnee { leporello } { column-widths-different } {
                \clist_item:Nn \l_leporello_columns_clist { \l_leporello_current_column_int }
            } {
                \clist_item:Nn \l_leporello_columns_clist { \l_leporello_box_flow_into_int }
            }
        }
        \box_new:c {
            g_leporello_box_flow_ \int_use:N \l_leporello_box_flow_into_int _box
        }
        \vbox_gset_top:cn {
            g_leporello_box_flow_ \int_use:N \l_leporello_box_flow_into_int _box
        } {
            \tl_use:c { g_leporello_box_ \int_use:N \l_leporello_current_box_int _tl }
        }
        \tl_clear:c { g_leporello_box_ \int_use:N \l_leporello_current_box_int _tl }
        \group_begin:
            \skip_set:Nn \splittopskip { 0pt }
            \vbox_gset_split_to_ht:Ncn \g_leporello_box_flow_temp_box {
                g_leporello_box_flow_ \int_use:N \l_leporello_box_flow_into_int _box
            } { 
                \dim_compare:nNnTF {
                    \prop_item:cn {
                        g_leporello_box_ \int_use:N \l_leporello_current_box_int _prop
                    } { height }
                } = { 0mm } {
                    \l_leporello_layout_height_dim
                } {
                    \prop_item:cn {
                        g_leporello_box_ \int_use:N \l_leporello_current_box_int _prop
                    } { height }
                }  -
                \prop_item:cn {
                    g_leporello_box_ \int_use:N \l_leporello_current_box_int _prop
                } { padding ~ top } -
                \prop_item:cn {
                    g_leporello_box_ \int_use:N \l_leporello_current_box_int _prop
                } { padding ~ bottom }
            }
        \group_end:
        \tl_if_exist:cF { g_leporello_box_ \int_use:N \l_leporello_box_flow_into_int _tl } {
            \tl_new:c { g_leporello_box_ \int_use:N \l_leporello_box_flow_into_int _tl }
        }
        \tl_gput_left:ce { g_leporello_box_ \int_use:N \l_leporello_box_flow_into_int _tl } {
            \exp_not:N \box_use_drop:c {
                g_leporello_box_flow_ \int_use:N \l_leporello_box_flow_into_int _box
            }
        }
        \vbox_top:n {
            \vbox_unpack_drop:N \g_leporello_box_flow_temp_box
        }
    }
}

\NewDocumentCommand { \leporellobreakbox } { } {
    %
}

\ExplSyntaxOff

\begin{leporellocolumn}{one}
\begin{leporellobox}[flow into={2}]
\lipsum
\end{leporellobox}
\end{leporellocolumn}

\begin{leporellocolumn}{two}
\begin{leporellobox}[background=yellow, stretch height, bleed={t,b}, flow into={3}]
\lipsum[1-2]
\end{leporellobox}
\end{leporellocolumn}

\begin{leporellocolumn}{three}
\begin{leporellobox}
\lipsum[1]
\end{leporellobox}
\end{leporellocolumn}

\begin{document}

\printleporellocolumns{one, two, three}

\end{document}